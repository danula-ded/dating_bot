# **–û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ Dating Bot**

## üèó **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram-–±–æ—Ç–∞**

### üì± **–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å**

- **Telegram Client** - –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **Polling/Webhook** - –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram.

### üñ• **–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (Producer)**

- **–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä**:
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Telegram.
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
  - –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã.

### üóÑ **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**

- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
- **Minio (S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞ (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ).
- **Redis**:
  - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
  - –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å–µ—Å—Å–∏–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è).

### üîÑ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Consumer)**

- **RabbitMQ** - –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è:
  - –î–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - –§–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- **Consumer-—Å–µ—Ä–≤–µ—Ä** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á –∏–∑ –æ—á–µ—Ä–µ–¥–∏.

### üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

- **Prometheus** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫:
  - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - –û—à–∏–±–∫–∏
  - –ù–∞–≥—Ä—É–∑–∫–∞

![–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∞](./Arhitecthure.jpg)

### **1. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **Frontend** ‚Üí Telegram Bot (`aiogram`).
2. **Backend Services** ‚Üí FastAPI (RESTful API).
3. **Database** ‚Üí PostgreSQL (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) + Redis (–∫—ç—à).
4. **Storage** ‚Üí MinIO (S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ñ–æ—Ç–æ).
5. **Message Broker** ‚Üí RabbitMQ (–¥–ª—è —Å–æ–±—ã—Ç–∏–π: –ª–∞–π–∫–∏, –ø—Ä–æ–ø—É—Å–∫–∏, –º—ç—Ç—á–∏).
6. **Celery** ‚Üí –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–ø–µ—Ä–µ—Å—á–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞, –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞).

---

### **2. –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)**

#### **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

#### **üîπ `users`**

```sql
CREATE TABLE users (
    user_id BIGINT PRIMARY KEY,         -- Telegram ID
    username VARCHAR(64),               -- @username
    first_name VARCHAR(64) NOT NULL,
    last_name VARCHAR(64),
    age INTEGER CHECK (age >= 18),      -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 18+
    gender VARCHAR(10) CHECK (gender IN ('male', 'female', 'other')),
    city VARCHAR(64),
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### **üîπ `profiles`**

```sql
CREATE TABLE profiles (
    profile_id SERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(user_id) ON DELETE CASCADE,
    bio TEXT,
    interests JSONB,                   -- –°–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤: ["–º—É–∑—ã–∫–∞", "—Å–ø–æ—Ä—Ç"]
    photo_urls TEXT[],                 -- –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–æ—Ç–æ –≤ MinIO (S3)
    preferred_gender VARCHAR(10),      -- –ö–æ–≥–æ –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    preferred_age_min INTEGER,         -- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
    preferred_age_max INTEGER,         -- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
    updated_at TIMESTAMP DEFAULT NOW()
);
```

#### **üîπ `ratings`**

```sql
CREATE TABLE ratings (
    rating_id SERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(user_id) ON DELETE CASCADE,
    primary_score FLOAT DEFAULT 0,     -- –ë–∞–ª–ª—ã –∑–∞ –∞–Ω–∫–µ—Ç—É (0-10)
    behavioral_score FLOAT DEFAULT 0,  -- –ë–∞–ª–ª—ã –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (0-10)
    total_rating FLOAT GENERATED ALWAYS AS (primary_score * 0.6 + behavioral_score * 0.4) STORED,
    last_updated TIMESTAMP DEFAULT NOW()
);
```

---

### **3. –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î**

#### **–¢–∞–±–ª–∏—Ü–∞ `users`**

| user_id | username   | first_name | age | gender | city   |
| ------- | ---------- | ---------- | --- | ------ | ------ |
| 123456  | @ivan_2023 | –ò–≤–∞–Ω       | 25  | male   | –ú–æ—Å–∫–≤–∞ |

#### **–¢–∞–±–ª–∏—Ü–∞ `profiles`**

| profile_id | user_id | bio                 | interests          | photo_urls        |
| ---------- | ------- | ------------------- | ------------------ | ----------------- |
| 1          | 123456  | "–õ—é–±–ª—é –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è" | ["–º—É–∑—ã–∫–∞", "–≥–æ—Ä—ã"] | ["s3/photo1.jpg"] |

#### **–¢–∞–±–ª–∏—Ü–∞ `ratings`**

| rating_id | user_id | primary_score | behavioral_score | total_rating |
| --------- | ------- | ------------- | ---------------- | ------------ |
| 1         | 123456  | 8.5           | 7.2              | 8.02         |

---

### **4. –ì–¥–µ —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è?**

| –î–∞–Ω–Ω—ã–µ                | –•—Ä–∞–Ω–∏–ª–∏—â–µ  |
| --------------------- | ---------- |
| –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | PostgreSQL |
| –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏            | MinIO (S3) |
| –ö—ç—à –∞–Ω–∫–µ—Ç             | Redis      |
| –û—á–µ—Ä–µ–¥–∏ —Å–æ–±—ã—Ç–∏–π       | RabbitMQ   |
